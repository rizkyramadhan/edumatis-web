{"ast":null,"code":"import _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nvar _jsxFileName = \"/Users/riz/Documents/edumatis-web/pages/app/screens/Login.tsx\";\nvar __jsx = React.createElement;\nimport query from \"../../../libs/queries/crud/query\";\nimport { checkSession } from \"../../../libs/queries/user/checkSession\";\nimport UIButton from \"../../../libs/ui/UIButton\";\nimport UIFieldText from \"../../../libs/ui/UIFieldText\";\nimport UIImage from \"../../../libs/ui/UIImage\";\nimport { RootStore } from \"../../../libs/stores/RootStore\";\nimport { observer, useObservable } from \"mobx-react-lite\";\nimport React, { useEffect } from \"react\";\nimport { Text, View, ScrollView } from \"react-native-web\";\nimport { createNavigateTo } from \"../../../libs/nav/NavContainer\";\nimport UIHead from \"../../../libs/ui/UIHead\";\nexport default observer(({\n  navigation\n}) => {\n  const navigateTo = createNavigateTo(navigation);\n  const data = useObservable({\n    sekolah_id: \"\",\n    nsa: \"\",\n    password: \"\"\n  });\n  const meta = useObservable({\n    sekolah: \"\",\n    murid: \"\",\n    loading: true\n  });\n  useEffect(() => {\n    (async () => {\n      const session = await checkSession();\n\n      if (session && session.murid && session.murid.nsa) {\n        if (session.murid.nsa === \"admin\") {\n          navigation.replace(\"Admin\");\n        } else {\n          navigation.replace(\"Siswa\");\n        }\n\n        return;\n      }\n\n      meta.loading = false;\n    })();\n  }, []);\n\n  if (meta.loading) {\n    return __jsx(View, {\n      style: {\n        flex: 1,\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        backgroundColor: \"#fff\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    }, __jsx(Text, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }, \"Loading...\"));\n  }\n\n  return __jsx(ScrollView, {\n    style: {\n      backgroundColor: \"#fff\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, __jsx(View, {\n    style: {\n      alignSelf: \"center\",\n      flexBasis: \"100%\",\n      minWidth: 400\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, __jsx(UIHead, {\n    navigation: navigation,\n    title: \"Menu Awal\",\n    onBack: () => {\n      navigateTo(\"Home\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }), __jsx(UIImage, {\n    source: require(\"../imgs/logo-edumatis_a.png\"),\n    mobileStyle: {\n      height: 150,\n      marginBottom: -10\n    },\n    style: {\n      width: 200,\n      alignSelf: \"center\",\n      marginTop: 10\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }), __jsx(Text, {\n    style: {\n      fontSize: 14,\n      fontWeight: 'bold',\n      alignSelf: 'center',\n      color: '#808080',\n      marginBottom: 10\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, \"Aman . Mudah . Handal . Hemat\"), __jsx(UIFieldText, {\n    label: \"ID Sekolah\",\n    sublabel: meta.sekolah,\n    value: data.sekolah_id,\n    setValue: value => data.sekolah_id = value,\n    onBlur: async () => {\n      try {\n        let res = await query(\"sekolah\", [\"nama_sekolah\"], {\n          where: {\n            id: _parseInt(data.sekolah_id)\n          },\n          useSession: false\n        });\n\n        if (res && res.nama_sekolah) {\n          meta.sekolah = res.nama_sekolah;\n        } else {\n          meta.sekolah = \"Sekolah tidak ditemukan\";\n        }\n      } catch (e) {}\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }), __jsx(UIFieldText, {\n    label: \"Nomor Induk / NSA\",\n    sublabel: meta.murid,\n    value: data.nsa,\n    setValue: value => data.nsa = value,\n    onBlur: async () => {\n      let res = await query(\"murid\", [\"nama_murid\"], {\n        where: {\n          sekolah_id: _parseInt(data.sekolah_id),\n          nsa: data.nsa\n        },\n        useSession: false\n      });\n\n      if (res && res.nama_murid) {\n        meta.murid = \"Nama: \" + res.nama_murid;\n      } else {\n        meta.murid = \"Nomor Induk tidak ditemukan\";\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }), __jsx(UIFieldText, {\n    type: \"password\",\n    label: \"Password\",\n    value: data.password,\n    setValue: value => data.password = value,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }), __jsx(UIButton, {\n    onPress: async () => {\n      meta.loading = true;\n      let session = await RootStore.session.login(data.sekolah_id, data.nsa, data.password);\n\n      if (session && session.murid && session.murid.nsa) {\n        if (session.murid.nsa === \"admin\") {\n          navigation.replace(\"Admin\");\n        } else {\n          navigation.replace(\"Siswa\");\n        }\n\n        return;\n      }\n\n      meta.loading = false;\n      location.reload();\n    },\n    style: {\n      alignItems: 'center'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, \"Login\")));\n});","map":{"version":3,"sources":["/Users/riz/Documents/edumatis-web/pages/app/screens/Login.tsx"],"names":["query","checkSession","UIButton","UIFieldText","UIImage","RootStore","observer","useObservable","React","useEffect","Text","View","ScrollView","createNavigateTo","UIHead","navigation","navigateTo","data","sekolah_id","nsa","password","meta","sekolah","murid","loading","session","replace","flex","alignItems","justifyContent","backgroundColor","alignSelf","flexBasis","minWidth","require","height","marginBottom","width","marginTop","fontSize","fontWeight","color","value","res","where","id","useSession","nama_sekolah","e","nama_murid","login","location","reload"],"mappings":"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","sourcesContent":["import query from \"@app/libs/queries/crud/query\";\nimport { checkSession } from \"@app/libs/queries/user/checkSession\";\nimport UIButton from \"@app/libs/ui/UIButton\";\nimport UIFieldText from \"@app/libs/ui/UIFieldText\";\nimport UIImage from \"@app/libs/ui/UIImage\";\nimport { RootStore } from \"@app/libs/stores/RootStore\";\nimport { observer, useObservable } from \"mobx-react-lite\";\nimport React, { useEffect } from \"react\";\nimport { Text, View, ScrollView } from \"react-native\";\nimport { createNavigateTo } from \"@app/libs/nav/NavContainer\";\nimport UIHead from '@app/libs/ui/UIHead';\n\nexport default observer(({ navigation }: any) => {\n  const navigateTo = createNavigateTo(navigation);\n  const data = useObservable({\n    sekolah_id: \"\",\n    nsa: \"\",\n    password: \"\"\n  });\n  const meta = useObservable({\n    sekolah: \"\",\n    murid: \"\",\n    loading: true\n  });\n\n  useEffect(() => {\n    (async () => {\n      const session = await checkSession();\n      if (session && session.murid && session.murid.nsa) {\n        if (session.murid.nsa === \"admin\") {\n          navigation.replace(\"Admin\");\n        } else {\n          navigation.replace(\"Siswa\");\n        }\n        return;\n      }\n      meta.loading = false;\n    })();\n  }, []);\n\n  if (meta.loading) {\n    return (\n      <View\n        style={{\n          flex: 1,\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          backgroundColor: \"#fff\"\n        }}\n      >\n        <Text>Loading...</Text>\n      </View>\n    );\n  }\n\n  return (\n    <ScrollView\n      style={{\n        backgroundColor: \"#fff\"\n      }}\n    >\n      <View style={{ alignSelf: \"center\", flexBasis: \"100%\", minWidth:400 }}>\n        <UIHead navigation={navigation} title=\"Menu Awal\" onBack={() => {\n          navigateTo(\"Home\");\n        }} />\n        \n        <UIImage\n          source={require(\"@app/imgs/logo-edumatis_a.png\")}\n          mobileStyle={{ height: 150, marginBottom: -10 }}\n          style={{ width: 200, alignSelf: \"center\", marginTop:10 }} \n        />\n        \n        <Text \n        style={{\n          fontSize: 14,\n          fontWeight: 'bold',\n          alignSelf: 'center',\n          color: '#808080',\n          marginBottom: 10,\n        }}\n        >Aman . Mudah . Handal . Hemat</Text>\n        \n        \n        <UIFieldText\n          label=\"ID Sekolah\"\n          sublabel={meta.sekolah}\n          value={data.sekolah_id}\n          setValue={(value: string) => (data.sekolah_id = value)}\n          onBlur={async () => {\n            try {\n              let res = await query(\"sekolah\", [\"nama_sekolah\"], {\n                where: { id: parseInt(data.sekolah_id) },\n                useSession: false\n              });\n              if (res && res.nama_sekolah) {\n                meta.sekolah = res.nama_sekolah;\n              } else {\n                meta.sekolah = \"Sekolah tidak ditemukan\";\n              }\n            } catch (e) {}\n          }}\n        />\n        <UIFieldText\n          label=\"Nomor Induk / NSA\"\n          sublabel={meta.murid}\n          value={data.nsa}\n          setValue={(value: string) => (data.nsa = value)}\n          onBlur={async () => {\n            let res = await query(\"murid\", [\"nama_murid\"], {\n              where: { sekolah_id: parseInt(data.sekolah_id), nsa: data.nsa },\n              useSession: false\n            });\n            if (res && res.nama_murid) {\n              meta.murid = \"Nama: \" + res.nama_murid;\n            } else {\n              meta.murid = \"Nomor Induk tidak ditemukan\";\n            }\n          }}\n        />\n        <UIFieldText\n          type=\"password\"\n          label=\"Password\"\n          value={data.password}\n          setValue={(value: string) => (data.password = value)}\n        />\n        <UIButton\n          onPress={async () => {\n            meta.loading = true;\n            let session = await (RootStore.session as any).login(\n              data.sekolah_id,\n              data.nsa,\n              data.password\n            );\n\n            if (session && session.murid && session.murid.nsa) {\n              if (session.murid.nsa === \"admin\") {\n                navigation.replace(\"Admin\");\n              } else {\n                navigation.replace(\"Siswa\");\n              }\n              return;\n            }\n            meta.loading = false;\n            location.reload();\n          }}\n          style={{alignItems: 'center'}}\n        >\n          Login\n        </UIButton>                \n      </View>\n    </ScrollView>\n  );\n});\n"]},"metadata":{},"sourceType":"module"}